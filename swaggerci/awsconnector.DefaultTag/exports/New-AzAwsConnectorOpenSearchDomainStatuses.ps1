
# ----------------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
# Code generated by Microsoft (R) AutoRest Code Generator.
# Changes may cause incorrect behavior and will be lost if the code is regenerated.
# ----------------------------------------------------------------------------------

<#
.Synopsis
Create a OpenSearchDomainStatus.
Please note that end user resource creation is currently restricted, but it will be enabled in the future.
.Description
Create a OpenSearchDomainStatus.
Please note that end user resource creation is currently restricted, but it will be enabled in the future.
.Example
{{ Add code here }}
.Example
{{ Add code here }}

.Outputs
Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Models.Api20241201.IOpenSearchDomainStatus
.Notes
COMPLEX PARAMETER PROPERTIES

To create the parameters described below, construct a hash table containing the appropriate properties. For information on hash tables, run Get-Help about_Hash_Tables.

AWSPROPERTY <IAwsOpenSearchDomainStatusProperties>: AWS Properties
  [AccessPolicy <String>]: <p>Identity and Access Management (IAM) policy document specifying the access policies for the domain.</p>
  [AdvancedOption <IAwsOpenSearchDomainStatusPropertiesAdvancedOptions>]: <p>Key-value pairs that specify advanced configuration options.</p>
    [(Any) <String>]: This indicates any property can be added to this object.
  [AdvancedSecurityOptionAnonymousAuthDisableDate <DateTime?>]: <p>Date and time when the migration period will be disabled. Only necessary when <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/fgac.html#fgac-enabling-existing'>enabling fine-grained access control on an existing domain</a>.</p>
  [AdvancedSecurityOptionAnonymousAuthEnabled <Boolean?>]: <p>True if a 30-day migration period is enabled, during which administrators can create role mappings. Only necessary when <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/fgac.html#fgac-enabling-existing'>enabling fine-grained access control on an existing domain</a>.</p>
  [AdvancedSecurityOptionEnabled <Boolean?>]: <p>True if fine-grained access control is enabled.</p>
  [AdvancedSecurityOptionInternalUserDatabaseEnabled <Boolean?>]: <p>True if the internal user database is enabled.</p>
  [Arn <String>]: <p>The Amazon Resource Name (ARN) of the domain. For more information, see <a href='https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html'>IAM identifiers </a> in the <i>AWS Identity and Access Management User Guide</i>.</p>
  [AutoTuneOptionErrorMessage <String>]: <p>Any errors that occurred while enabling or disabling Auto-Tune.</p>
  [AutoTuneOptionUseOffPeakWindow <Boolean?>]: <p>Whether the domain's off-peak window will be used to deploy Auto-Tune changes rather than a maintenance schedule.</p>
  [ChangeProgressDetailChangeId <String>]: <p>The ID of the configuration change.</p>
  [ChangeProgressDetailLastUpdatedTime <DateTime?>]: <p>The last time that the configuration change was updated.</p>
  [ChangeProgressDetailMessage <String>]: <p>A message corresponding to the status of the configuration change.</p>
  [ChangeProgressDetailStartTime <DateTime?>]: <p>The time that the configuration change was initiated, in Universal Coordinated Time (UTC).</p>
  [ClusterConfigDedicatedMasterCount <Int32?>]: <p>Number of dedicated master nodes in the cluster. This number must be greater than 2 and not 4, otherwise you receive a validation exception.</p>
  [ClusterConfigDedicatedMasterEnabled <Boolean?>]: <p>Indicates whether dedicated master nodes are enabled for the cluster.<code>True</code> if the cluster will use a dedicated master node.<code>False</code> if the cluster will not.</p>
  [ClusterConfigInstanceCount <Int32?>]: <p>Number of data nodes in the cluster. This number must be greater than 1, otherwise you receive a validation exception.</p>
  [ClusterConfigMultiAzWithStandbyEnabled <Boolean?>]: <p>A boolean that indicates whether a multi-AZ domain is turned on with a standby AZ. For more information, see <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/managedomains-multiaz.html'>Configuring a multi-AZ domain in Amazon OpenSearch Service</a>. </p>
  [ClusterConfigWarmCount <Int32?>]: <p>The number of warm nodes in the cluster.</p>
  [ClusterConfigWarmEnabled <Boolean?>]: <p>Whether to enable warm storage for the cluster.</p>
  [ClusterConfigZoneAwarenessEnabled <Boolean?>]: <p>Indicates whether multiple Availability Zones are enabled. For more information, see <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/managedomains-multiaz.html'>Configuring a multi-AZ domain in Amazon OpenSearch Service</a>.</p>
  [CognitoOptionEnabled <Boolean?>]: <p>Whether to enable or disable Amazon Cognito authentication for OpenSearch Dashboards.</p>
  [CognitoOptionIdentityPoolId <String>]: <p>The Amazon Cognito identity pool ID that you want OpenSearch Service to use for OpenSearch Dashboards authentication.</p>
  [CognitoOptionRoleArn <String>]: <p>The <code>AmazonOpenSearchServiceCognitoAccess</code> role that allows OpenSearch Service to configure your user pool and identity pool.</p>
  [CognitoOptionUserPoolId <String>]: <p>The Amazon Cognito user pool ID that you want OpenSearch Service to use for OpenSearch Dashboards authentication.</p>
  [ColdStorageOptionEnabled <Boolean?>]: <p>Whether to enable or disable cold storage on the domain. You must enable UltraWarm storage to enable cold storage.</p>
  [ConfigChangeStatusValue <ConfigChangeStatus?>]: Property value
  [Created <Boolean?>]: <p>Creation status of an OpenSearch Service domain. True if domain creation is complete. False if domain creation is still in progress.</p>
  [DedicatedMasterTypeValue <OpenSearchPartitionInstanceType?>]: Property value
  [Deleted <Boolean?>]: <p>Deletion status of an OpenSearch Service domain. True if domain deletion is complete. False if domain deletion is still in progress. Once deletion is complete, the status of the domain is no longer returned.</p>
  [DomainEndpointOptionCustomEndpoint <String>]: <p>The fully qualified URL for the custom endpoint.</p>
  [DomainEndpointOptionCustomEndpointCertificateArn <String>]: <p>The ARN for your security certificate, managed in Amazon Web Services Certificate Manager (ACM).</p>
  [DomainEndpointOptionCustomEndpointEnabled <Boolean?>]: <p>Whether to enable a custom endpoint for the domain.</p>
  [DomainEndpointOptionEnforceHttps <Boolean?>]: <p>True to require that all traffic to the domain arrive over HTTPS.</p>
  [DomainId <String>]: <p>Unique identifier for the domain.</p>
  [DomainName <String>]: <p>Name of the domain. Domain names are unique across all domains owned by the same account within an Amazon Web Services Region.</p>
  [DomainProcessingStatusValue <DomainProcessingStatusType?>]: Property value
  [EbOptionEbsEnabled <Boolean?>]: <p>Indicates whether EBS volumes are attached to data nodes in an OpenSearch Service domain.</p>
  [EbOptionIop <Int32?>]: <p>Specifies the baseline input/output (I/O) performance of EBS volumes attached to data nodes. Applicable only for the <code>gp3</code> and provisioned IOPS EBS volume types.</p>
  [EbOptionThroughput <Int32?>]: <p>Specifies the throughput (in MiB/s) of the EBS volumes attached to data nodes. Applicable only for the <code>gp3</code> volume type.</p>
  [EbOptionVolumeSize <Int32?>]: <p>Specifies the size (in GiB) of EBS volumes attached to data nodes.</p>
  [EncryptionAtRestOptionEnabled <Boolean?>]: <p>True to enable encryption at rest.</p>
  [EncryptionAtRestOptionKmsKeyId <String>]: <p>The KMS key ID. Takes the form <code>1a2a3a4-1a2a-3a4a-5a6a-1a2a3a4a5a6a</code>.</p>
  [Endpoint <String>]: <p>Domain-specific endpoint used to submit index, search, and data upload requests to the domain.</p>
  [EndpointV2 <String>]: <p>If <code>IPAddressType</code> to set to <code>dualstack</code>, a version 2 domain endpoint is provisioned. This endpoint functions like a normal endpoint, except that it works with both IPv4 and IPv6 IP addresses. Normal endpoints work only with IPv4 IP addresses. </p>
  [Endpoints <IAwsOpenSearchDomainStatusPropertiesEndpoints>]: <p>The key-value pair that exists if the OpenSearch Service domain uses VPC endpoints. Example <code>key, value</code>: <code>'vpc','vpc-endpoint-h2dsd34efgyghrtguk5gt6j2foh4.us-east-1.es.amazonaws.com'</code>.</p>
    [(Any) <String>]: This indicates any property can be added to this object.
  [EngineVersion <String>]: <p>Version of OpenSearch or Elasticsearch that the domain is running, in the format <code>Elasticsearch_X.Y</code> or <code>OpenSearch_X.Y</code>.</p>
  [IPAddressTypeValue <IPAddressType?>]: Property value
  [IdpEntityId <String>]: <p>The unique entity ID of the application in the SAML identity provider.</p>
  [IdpMetadataContent <String>]: <p>The metadata of the SAML application, in XML format.</p>
  [InitiatedByValue <InitiatedBy?>]: Property value
  [InstanceTypeValue <OpenSearchPartitionInstanceType?>]: Property value
  [LogPublishingOption <IAwsOpenSearchDomainStatusPropertiesLogPublishingOptions>]: <p>Log publishing options for the domain.</p>
    [(Any) <ILogPublishingOption>]: This indicates any property can be added to this object.
  [ModifyingProperty <IModifyingProperties[]>]: <p>Information about the domain properties that are currently being modified.</p>
    [ActiveValue <String>]: <p>The current value of the domain property that is being modified.</p>
    [Name <String>]: <p>The name of the property that is currently being modified.</p>
    [PendingValue <String>]: <p>The value that the property that is currently being modified will eventually have.</p>
    [ValueTypeValue <PropertyValueType?>]: Property value
  [NodeToNodeEncryptionOptionEnabled <Boolean?>]: <p>True to enable node-to-node encryption.</p>
  [OffPeakWindowOptionEnabled <Boolean?>]: <p>Whether to enable an off-peak window.</p> <p>This option is only available when modifying a domain created prior to February 16, 2023, not when creating a new domain. All domains created after this date have the off-peak window enabled by default. You can't disable the off-peak window after it's enabled for a domain.</p>
  [Processing <Boolean?>]: <p>The status of the domain configuration. True if OpenSearch Service is processing configuration changes. False if the configuration is active.</p>
  [SamlOptionEnabled <Boolean?>]: <p>True if SAML is enabled.</p>
  [SamlOptionRolesKey <String>]: <p>The key used for matching the SAML roles attribute.</p>
  [SamlOptionSessionTimeoutMinute <Int32?>]: <p>The duration, in minutes, after which a user session becomes inactive.</p>
  [SamlOptionSubjectKey <String>]: <p>The key used for matching the SAML subject attribute.</p>
  [ServiceSoftwareOptionAutomatedUpdateDate <DateTime?>]: <p>The timestamp, in Epoch time, until which you can manually request a service software update. After this date, we automatically update your service software.</p>
  [ServiceSoftwareOptionCancellable <Boolean?>]: <p> True if you're able to cancel your service software version update. False if you can't cancel your service software update.</p>
  [ServiceSoftwareOptionCurrentVersion <String>]: <p>The current service software version present on the domain.</p>
  [ServiceSoftwareOptionDescription <String>]: <p>A description of the service software update status.</p>
  [ServiceSoftwareOptionNewVersion <String>]: <p>The new service software version, if one is available.</p>
  [ServiceSoftwareOptionOptionalDeployment <Boolean?>]: <p>True if a service software is never automatically updated. False if a service software is automatically updated after the automated update date.</p>
  [ServiceSoftwareOptionUpdateAvailable <Boolean?>]: <p>True if you're able to update your service software version. False if you can't update your service software version.</p>
  [SnapshotOptionAutomatedSnapshotStartHour <Int32?>]: <p>The time, in UTC format, when OpenSearch Service takes a daily automated snapshot of the specified domain. Default is <code>0</code> hours.</p>
  [SoftwareUpdateOptionAutoSoftwareUpdateEnabled <Boolean?>]: <p>Whether automatic service software updates are enabled for the domain.</p>
  [StateValue <AutoTuneState?>]: Property value
  [TlSecurityPolicyValue <TlsSecurityPolicy?>]: Property value
  [UpdateStatusValue <DeploymentStatus?>]: Property value
  [UpgradeProcessing <Boolean?>]: <p>The status of a domain version upgrade to a new version of OpenSearch or Elasticsearch. True if OpenSearch Service is in the process of a version upgrade. False if the configuration is active.</p>
  [VolumeTypeValue <VolumeType?>]: Property value
  [VpcOptionAvailabilityZone <String[]>]: <p>The list of Availability Zones associated with the VPC subnets.</p>
  [VpcOptionSecurityGroupId <String[]>]: <p>The list of security group IDs associated with the VPC endpoints for the domain.</p>
  [VpcOptionSubnetId <String[]>]: <p>A list of subnet IDs associated with the VPC endpoints for the domain.</p>
  [VpcOptionVpcId <String>]: <p>The ID for your VPC. Amazon VPC generates this value when you create a VPC.</p>
  [WarmTypeValue <OpenSearchWarmPartitionInstanceType?>]: Property value
  [WindowStartTimeHour <Int64?>]: <p>The start hour of the window in Coordinated Universal Time (UTC), using 24-hour time. For example, <code>17</code> refers to 5:00 P.M. UTC.</p>
  [WindowStartTimeMinute <Int64?>]: <p>The start minute of the window, in UTC.</p>
  [ZoneAwarenessConfigAvailabilityZoneCount <Int32?>]: <p>If you enabled multiple Availability Zones, this value is the number of zones that you want the domain to use. Valid values are <code>2</code> and <code>3</code>. If your domain is provisioned within a VPC, this value be equal to number of subnets.</p>
.Link
https://learn.microsoft.com/powershell/module/az.awsconnector/new-azawsconnectoropensearchdomainstatuses
#>
function New-AzAwsConnectorOpenSearchDomainStatuses {
[OutputType([Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Models.Api20241201.IOpenSearchDomainStatus])]
[CmdletBinding(DefaultParameterSetName='CreateExpanded', PositionalBinding=$false, SupportsShouldProcess, ConfirmImpact='Medium')]
param(
    [Parameter(Mandatory)]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Path')]
    [System.String]
    # Name of OpenSearchDomainStatus
    ${Name},

    [Parameter(Mandatory)]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Path')]
    [System.String]
    # The name of the resource group.
    # The name is case insensitive.
    ${ResourceGroupName},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Path')]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.DefaultInfo(Script='(Get-AzContext).Subscription.Id')]
    [System.String]
    # The ID of the target subscription.
    # The value must be an UUID.
    ${SubscriptionId},

    [Parameter(Mandatory)]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [System.String]
    # The geo-location where the resource lives
    ${Location},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [System.String]
    # Amazon Resource Name (ARN)
    ${Arn},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [System.String]
    # AWS Account ID
    ${AwsAccountId},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Models.Api20241201.IAwsOpenSearchDomainStatusProperties]
    # AWS Properties
    # To construct, see NOTES section for AWSPROPERTY properties and create a hash table.
    ${AwsProperty},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [System.String]
    # AWS Region
    ${AwsRegion},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [System.String]
    # AWS Source Schema
    ${AwsSourceSchema},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.Info(PossibleTypes=([Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Models.Api20241201.IOpenSearchDomainStatusPropertiesAwsTags]))]
    [System.Collections.Hashtable]
    # AWS Tags
    ${AwsTag},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [System.String]
    # Public Cloud Connectors Resource ID
    ${PublicCloudConnectorsResourceId},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [System.String]
    # Public Cloud Resource Name
    ${PublicCloudResourceName},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Body')]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.Info(PossibleTypes=([Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Models.Api50.ITrackedResourceTags]))]
    [System.Collections.Hashtable]
    # Resource tags.
    ${Tag},

    [Parameter()]
    [Alias('AzureRMContext', 'AzureCredential')]
    [ValidateNotNull()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Azure')]
    [System.Management.Automation.PSObject]
    # The DefaultProfile parameter is not functional.
    # Use the SubscriptionId parameter when available if executing the cmdlet against a different subscription.
    ${DefaultProfile},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [System.Management.Automation.SwitchParameter]
    # Run the command as a job
    ${AsJob},

    [Parameter(DontShow)]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [System.Management.Automation.SwitchParameter]
    # Wait for .NET debugger to attach
    ${Break},

    [Parameter(DontShow)]
    [ValidateNotNull()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.SendAsyncStep[]]
    # SendAsync Pipeline Steps to be appended to the front of the pipeline
    ${HttpPipelineAppend},

    [Parameter(DontShow)]
    [ValidateNotNull()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.SendAsyncStep[]]
    # SendAsync Pipeline Steps to be prepended to the front of the pipeline
    ${HttpPipelinePrepend},

    [Parameter()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [System.Management.Automation.SwitchParameter]
    # Run the command asynchronously
    ${NoWait},

    [Parameter(DontShow)]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [System.Uri]
    # The URI for the proxy server to use
    ${Proxy},

    [Parameter(DontShow)]
    [ValidateNotNull()]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [System.Management.Automation.PSCredential]
    # Credentials for a proxy server to use for the remote call
    ${ProxyCredential},

    [Parameter(DontShow)]
    [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Category('Runtime')]
    [System.Management.Automation.SwitchParameter]
    # Use the default credentials for the proxy
    ${ProxyUseDefaultCredentials}
)

begin {
    try {
        $outBuffer = $null
        if ($PSBoundParameters.TryGetValue('OutBuffer', [ref]$outBuffer)) {
            $PSBoundParameters['OutBuffer'] = 1
        }
        $parameterSet = $PSCmdlet.ParameterSetName

        if ($null -eq [Microsoft.WindowsAzure.Commands.Utilities.Common.AzurePSCmdlet]::PowerShellVersion) {
            [Microsoft.WindowsAzure.Commands.Utilities.Common.AzurePSCmdlet]::PowerShellVersion = $PSVersionTable.PSVersion.ToString()
        }         
        $preTelemetryId = [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::TelemetryId
        if ($preTelemetryId -eq '') {
            [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::TelemetryId =(New-Guid).ToString()
            [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.module]::Instance.Telemetry.Invoke('Create', $MyInvocation, $parameterSet, $PSCmdlet)
        } else {
            $internalCalledCmdlets = [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::InternalCalledCmdlets
            if ($internalCalledCmdlets -eq '') {
                [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::InternalCalledCmdlets = $MyInvocation.MyCommand.Name
            } else {
                [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::InternalCalledCmdlets += ',' + $MyInvocation.MyCommand.Name
            }
            [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::TelemetryId = 'internal'
        }

        $mapping = @{
            CreateExpanded = 'Az.AwsConnector.private\New-AzAwsConnectorOpenSearchDomainStatuses_CreateExpanded';
        }
        if (('CreateExpanded') -contains $parameterSet -and -not $PSBoundParameters.ContainsKey('SubscriptionId')) {
            $testPlayback = $false
            $PSBoundParameters['HttpPipelinePrepend'] | Foreach-Object { if ($_) { $testPlayback = $testPlayback -or ('Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.PipelineMock' -eq $_.Target.GetType().FullName -and 'Playback' -eq $_.Target.Mode) } }
            if ($testPlayback) {
                $PSBoundParameters['SubscriptionId'] = . (Join-Path $PSScriptRoot '..' 'utils' 'Get-SubscriptionIdTestSafe.ps1')
            } else {
                $PSBoundParameters['SubscriptionId'] = (Get-AzContext).Subscription.Id
            }
        }
        $cmdInfo = Get-Command -Name $mapping[$parameterSet]
        [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.MessageAttributeHelper]::ProcessCustomAttributesAtRuntime($cmdInfo, $MyInvocation, $parameterSet, $PSCmdlet)
        if ($null -ne $MyInvocation.MyCommand -and [Microsoft.WindowsAzure.Commands.Utilities.Common.AzurePSCmdlet]::PromptedPreviewMessageCmdlets -notcontains $MyInvocation.MyCommand.Name -and [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.MessageAttributeHelper]::ContainsPreviewAttribute($cmdInfo, $MyInvocation)){
            [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.Runtime.MessageAttributeHelper]::ProcessPreviewMessageAttributesAtRuntime($cmdInfo, $MyInvocation, $parameterSet, $PSCmdlet)
            [Microsoft.WindowsAzure.Commands.Utilities.Common.AzurePSCmdlet]::PromptedPreviewMessageCmdlets.Enqueue($MyInvocation.MyCommand.Name)
        }
        $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand(($mapping[$parameterSet]), [System.Management.Automation.CommandTypes]::Cmdlet)
        $scriptCmd = {& $wrappedCmd @PSBoundParameters}
        $steppablePipeline = $scriptCmd.GetSteppablePipeline($MyInvocation.CommandOrigin)
        $steppablePipeline.Begin($PSCmdlet)
    } catch {
        [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::ClearTelemetryContext()
        throw
    }
}

process {
    try {
        $steppablePipeline.Process($_)
    } catch {
        [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::ClearTelemetryContext()
        throw
    }

    finally {
        $backupTelemetryId = [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::TelemetryId
        $backupInternalCalledCmdlets = [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::InternalCalledCmdlets
        [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::ClearTelemetryContext()
    }

}
end {
    try {
        $steppablePipeline.End()

        [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::TelemetryId = $backupTelemetryId
        [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::InternalCalledCmdlets = $backupInternalCalledCmdlets
        if ($preTelemetryId -eq '') {
            [Microsoft.Azure.PowerShell.Cmdlets.AwsConnector.module]::Instance.Telemetry.Invoke('Send', $MyInvocation, $parameterSet, $PSCmdlet)
            [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::ClearTelemetryContext()
        }
        [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::TelemetryId = $preTelemetryId

    } catch {
        [Microsoft.WindowsAzure.Commands.Common.MetricHelper]::ClearTelemetryContext()
        throw
    }
} 
}
